project_face_recog.py  
project_mosq1602A_LED.c  
스마트폰 mqtt 통신  

#Project : 사람 판별 스마트 홈	 
    • 집안에 들어온 사람의 얼굴을 인식 후 서버에 메시지 대상에게 맞는 IOT들을 작동한다  
    • INDEX : 참여자/ 프로젝트 개요/ 작동과정/ 작동사진/ 부품 및 개발환경/ 구현과정/ 고찰  
  
    • 참여자 : 강호철  
    • 프로젝트 개요  
카메라로부터 촬영된 영상을 컴퓨터비전 OpenCV를 활용해 신원을 확인한다. 그리고 다수의 MQTT서버를 통해 카메라, 집안의 IOT기기, 멀리 있는 유저들 3자간 메시지와 사진을 주고받고 신원을 확인한대로 그 대상에 맞는 IOT들을 작동시킨다.
얼굴인식 영상처리와 MQTT 프로토콜 Publisher를 파이썬 프로그램에서 제어한다  
라즈베리파이와 MQTT 프로토콜 Subscriber를 C 프로그램에서 제어한다  
  
    • 프로젝트 작동과정
    1. 누군가 출입 시 얼굴인식 후 권한을 가지고있는 사람들 (가족들) my/home/VIDEO (mqtt브로커)에게 누가 들어왔는지 메시지를 전달한다.
    2. 본인이라면 동시에 IOT기기들에게도 mqtt를 전달해 LED를키고 ㅇㅇ님, 환영한다는 LCD를 띄우는 명령을 내린다. 
    3. DH11을 작동시켜 현재 실내 온도, 습도를 확인 후 LCD에 알려주고 기록되어있는 사용자 최적의 온도를 토대로 IOT기기들 (ex에어컨A과 난방B)을 작동시켜 주도록 한다.
    4. 만약 본인이(혹은 등록된 사용자가) 아니라면, IOT기기 LCD에게 허가되지 않은 사용자는 나가달라는 명령과 경찰에 신고하겠다는 문장을 띄운다.
    5. 그리고 가족들에게 신원불명의 사람이 집안에 들어왔음을 알리는 경고를 보내고
범인의 사진을 전송 받는다.
    6. my/home/LED에게 ‘0’을 입력한다면 주인은 집안의 불, 작동되는 IOT들을 의도적으로 종료가능하다

.
    • 작동과정 사진
0. 준비 ) 학습시킬 사진파일 me.jpg 폴더에 넣기
사용자를 인식
           
    1. 유저의 스마트폰에 알람이 온다 led 1 작동.  낮선사람이라면 5초마다 얼굴사진이 전달 
                             

    2. 등록된사용자라면 LCD를 띄운다	     등록되지 않은 사용자라면 LCD에 경고를 띄우고
      
    3. LED를 작동시킨다. 에어컨~난방		호스트에게 얼굴이 전송됬음을 알린다.
               
    4. 이제 ME에 현재온도를 받아와 띄우고 
설정된 유저의 희망온도에 따라 에어컨, 온풍기(사실 초록, 노랑led)를 작동시키면 된다.
			 
6. 혹은 유저는 집밖에서 ‘0’을 입력해
IOT들을 임의로 원거리 종료가 가능하다. 
    • 부품 및 개발환경
RaspberryPi 4.0 , rapiCamera 2.1v ,1602A, DH11, LED 3ea, 저항 3ea, Bread board ,점퍼케이블 
리눅스(구현환경), Mqtt Mosqutto(서버), VisualStudio Code(개발환경)
    • 구현 코드 작성 과정
Face_recog.py


    




    • 고찰 및 문제점
파이썬 쓰레드를 활용해 MQTT작업과 분산처리 작업을 하게한다.
- 영상촬영분석과 처리가 오래걸려 송수신 속도가 느려져 타임랙이 발생
- 사진과 판독 학습의 능력이 매우 떨어져 새로운 학습 모델이 필요.
- MQTT 쓰레드가 메시지, 이미지 mqtt를 관리해 하드웨어적 부족을 일정부분 해소한다
C 쓰레드를 활용해 IOT통제시스템과 MQTT 받는부분을 분산처리한다.
- 라즈베리파이의 DH11를 제어해 들어온 데이터들을 1602A와 LED에 출력한다.
- DH11가 측정값을 읽어들이기가 어려워 더 좋은 온,습도 측정모듈이 필요하다. 
- 602A모델에서 한글을 사용하려면 커서가 라인이 아닌 글자단위로 들어가서 8줄을 읽어들일 필요가있다.
MQTT 서버를 활용해 유저, 프로그램, IOT 3자간 원거리에서 데이터를 주고받을수있다.
